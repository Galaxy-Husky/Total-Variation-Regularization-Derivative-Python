(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51551,       1208]
NotebookOptionsPosition[     48805,       1150]
NotebookOutlinePosition[     49203,       1166]
CellTagsIndexPosition[     49160,       1163]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Load package", "Chapter",
 CellChangeTimes->{{3.822074504763748*^9, 
  3.822074506410431*^9}},ExpressionUUID->"f506f164-c0f0-463a-b883-\
cac9e42bcd3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<diffTVR`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.8220743669845324`*^9, 3.822074372381111*^9}, {
  3.822074484169373*^9, 3.822074487916696*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f3e032d6-f11e-456f-9a3e-5a51888c61c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "diffTVR`*"}]], "Input",
 CellChangeTimes->{{3.822074440374161*^9, 3.82207444317091*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"3ace6ebf-5416-4142-8769-81bdbabe7877"],

Cell[BoxData[
 StyleBox[
  FrameBox[GridBox[{
     {
      DynamicModuleBox[{Typeset`open$$ = True}, 
       PaneSelectorBox[{False->
        ButtonBox[
         RowBox[{
          
          DynamicBox[FEPrivate`FrontEndResource[
           "FEBitmaps", "RightPointerOpener"]], " ", 
          StyleBox["diffTVR`", "InformationGridGroupHeader"]}],
         Appearance->None,
         BaseStyle->"InformationGridLink",
         ButtonFunction:>FEPrivate`Set[Typeset`open$$, True],
         Evaluator->Automatic,
         Method->"Preemptive"], True->
        PaneBox[GridBox[{
           {
            ButtonBox[
             RowBox[{
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {3., 7.}}], " ", 
              StyleBox["diffTVR`", "InformationGridGroupHeader"]}],
             Appearance->None,
             BaseStyle->"InformationGridLink",
             ButtonFunction:>FEPrivate`Set[Typeset`open$$, False],
             Evaluator->Automatic,
             Method->"Preemptive"]},
           {
            PaneBox[GridBox[{
               {
                ButtonBox[
                 StyleBox["getDiffTVR", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-196a39e8-488b-4626-94dc-8bea1c84bbfb", {
                   "getDiffTVR", "diffTVR`"}, False},
                 ButtonNote->"diffTVR`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["getDiffTVRGivenStructs", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-196a39e8-488b-4626-94dc-8bea1c84bbfb", {
                   "getDiffTVRGivenStructs", "diffTVR`"}, False},
                 ButtonNote->"diffTVR`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["getDiffTVRupdate", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-196a39e8-488b-4626-94dc-8bea1c84bbfb", {
                   "getDiffTVRupdate", "diffTVR`"}, False},
                 ButtonNote->"diffTVR`",
                 Evaluator->Automatic], 
                ButtonBox[
                 
                 StyleBox["getDiffTVRupdateGivenStructs", 
                  "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-196a39e8-488b-4626-94dc-8bea1c84bbfb", {
                   "getDiffTVRupdateGivenStructs", "diffTVR`"}, False},
                 ButtonNote->"diffTVR`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["makeTVRstructs", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-196a39e8-488b-4626-94dc-8bea1c84bbfb", {
                   "makeTVRstructs", "diffTVR`"}, False},
                 ButtonNote->"diffTVR`",
                 Evaluator->Automatic]}
              },
              DefaultBaseStyle->"Text",
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
              GridBoxItemSize->{"Columns" -> {{
                   Scaled[0.19]}}}],
             ImageMargins->{{10, 0}, {0, 2}}]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
         FrameMargins->{{0, 0}, {8, 0}}]}, Dynamic[Typeset`open$$],
        ImageSize->Automatic]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{"ColumnsIndexed" -> {{False}}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.8]}, 
        Offset[0.2]}}],
   BaseStyle->"InformationTitleFrame"], "InformationGridPlain"]], "Output",
 CellChangeTimes->{3.822074443481799*^9, 3.8220746803636703`*^9, 
  3.8220780124928427`*^9, 3.822446487464629*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"828a75ba-f5c3-488d-9d6c-c4da9503e135"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Absolute value, white noise", "Title",
 CellChangeTimes->{{3.822074726072303*^9, 3.82207472881537*^9}, {
  3.82207522695708*^9, 
  3.822075228352322*^9}},ExpressionUUID->"b7f822b6-9baf-4688-a125-\
f8509e18632f"],

Cell[CellGroupData[{

Cell["Data", "Chapter",
 CellChangeTimes->{{3.8220745110632763`*^9, 
  3.822074518907728*^9}},ExpressionUUID->"a392b314-8eaf-4606-b7c2-\
350ea789a805"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<DefaultPlotStyle\>\"", "/.", " ", 
       RowBox[{"(", 
        RowBox[{"Method", "/.", " ", 
         RowBox[{"Charting`ResolvePlotTheme", "[", 
          RowBox[{"\"\<Scientific\>\"", ",", "ListLinePlot"}], "]"}]}], 
        ")"}]}], ")"}], "/.", " ", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{"x_", ",", "__"}], "]"}], "\[RuleDelayed]", "x"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleExactF", "=", 
   RowBox[{"Darker", "[", "Green", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleExact", "=", 
   RowBox[{"Opacity", "[", 
    RowBox[{"0.4", ",", 
     RowBox[{"Darker", "[", "Green", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleNoisy", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{
     RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
     RowBox[{"colors", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleFiltered1", "=", 
   RowBox[{"colors", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleFiltered2", "=", 
   RowBox[{"Darker", "[", "Magenta", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleAve", "=", "Brown"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleTVR", "=", "Black"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleTVRFiltered", "=", "Gray"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleFiltered1Filtered", "=", 
   RowBox[{"Lighter", "[", "styleFiltered1", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleFiltered2Filtered", "=", 
   RowBox[{"Lighter", "[", "styleFiltered2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styleNoisyFiltered", "=", "Blue"}], ";"}]}], "Input",
 CellChangeTimes->{{3.822080364109148*^9, 3.8220804030326*^9}, {
  3.822080459324828*^9, 3.822080469482498*^9}, {3.822080533293442*^9, 
  3.822080546966855*^9}, {3.822080624402416*^9, 3.822080633396042*^9}, {
  3.822080666812296*^9, 3.822080667480496*^9}, {3.8220807025122538`*^9, 
  3.822080708159739*^9}, {3.8220809702649183`*^9, 3.8220809737896137`*^9}, {
  3.822081041128613*^9, 3.822081045141851*^9}, {3.822081223892832*^9, 
  3.822081271338377*^9}, {3.822081783296955*^9, 3.822081786781722*^9}, {
  3.8220821024710217`*^9, 3.822082106366267*^9}, {3.82208214163734*^9, 
  3.82208216211764*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"78221468-84d4-4909-8592-d7ee93cf5a0e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataExact", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"x", "-", "0.5"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1", ",", "dx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataNoisy", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"x", "+", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "0.05"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "dataExact"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leg", "=", 
   RowBox[{"LineLegend", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"styleExact", ",", "styleNoisy"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Exact signal\>\"", ",", "\"\<Noisy signal\>\""}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pltData", "=", 
  RowBox[{"Grid", "[", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dataNoisy", ",", "dataExact"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"styleNoisy", ",", "styleExact"}], "}"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", "\"\<Time\>\"", "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Signal\>\""}]}], "]"}], ",", 
      "leg"}], "}"}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.821994658483042*^9, 3.82199470308302*^9}, 
   3.821995607144384*^9, {3.821995978161849*^9, 3.8219959789366426`*^9}, {
   3.821996019909335*^9, 3.821996019973658*^9}, {3.821996087757765*^9, 
   3.8219961044957743`*^9}, {3.821996153919792*^9, 3.821996159095829*^9}, {
   3.821996321171908*^9, 3.821996323522456*^9}, {3.8219971268288794`*^9, 
   3.82199712688958*^9}, {3.821997250564582*^9, 3.821997254695437*^9}, {
   3.821997447742552*^9, 3.821997449400614*^9}, 3.821997610310317*^9, {
   3.822008132906143*^9, 3.8220081355838127`*^9}, {3.822008247396161*^9, 
   3.822008290034176*^9}, {3.822074850569849*^9, 3.822074851950426*^9}, {
   3.822446531540987*^9, 3.8224466018299828`*^9}, {3.822446656310828*^9, 
   3.82244668174302*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"62725fc3-d230-4d44-a76a-5cdd913fd5a5"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[{{}, {{}, {}, 
        {RGBColor[0.9, 0.36, 0.054], PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
         Opacity[0.7], CapForm["Butt"], 
         StyleBox[LineBox[CompressedData["
1:eJw1lA001XcYx++isWl1bdbWUGPeEpoSeWm+3l3CvVzXSx0zB8tENrM0sj+n
lCNzTPPSShSOEcpbB7mu1xSS9w1hZW0HybZ2nTMz247nd8/5n3s+/8/veZ7f
+f2f36MVcsI7bBOPxwv77/n/f+O3bOucmhjXbvyTLb1AavTunTsMp4mVsemz
03v+Mn1CzIe8smVdLp0hVsOXcyGD4esTxG9DVlqkq9g5TqyBkDuiHJPUH4nf
hXKp0snIj4eJtRHE3569bcsYsQ6CPK6arvU/ItaDtLXrsrT2B2IDcDGZAUcK
WT1DjKxpnRqJnCQ2wt3EaCN5JFtvgr01SUqNgSz/+5Bcnhr43ZGxKbQqs+9w
/CnifWjIGkoq0h8i3g8u+ZF6WRPLZ4bFiMJr/V1s/wegti19tSSOrTdHfFho
6Yywl9gCbwZvXVkdHSE+iMKW7wpPebJ4S2irJC1UT3UTW2Fnd5zylRwWb42k
KtgNZDC2gVJN+phAeo/4EFK0veoS53uIP8An/W8haqqP2BZ/jHzfn6zC6gPi
nALJ/qXODeYAo77qwKdjxDw7pIz0DeuXt5K3g2Wa+kEPaT95e/Cqc4f4vzaR
t0fte6rCx690kHdATYZDx2PdLvIOyPwwxSrero28I5oadhxbrKgl7whN4Vq1
VreMvBM0DPW8wm2k5J1wTpghytheRN4Z1g8akuQvqB7njAmHiT+bNzWTd0Hx
klR0s6uCvAuCXDj7aE1initClAst/45pIe8KjyWlspqqktYNL4BQQdLjVlVC
XgDdf3Y7jeVeI++GLXxc8NxVvcGcG+YCS5LvVhSQd8f0uEFnrHUZeXccNSmZ
WdlTTPUPY/70iqR9pYb8YXCXPOt/e/41xXtA5wZuW/Vkk/fAMV8Dt6zbF8l7
olN1l9c3Fuz8PXFfWH/xZMItyu+F7r7BfOtSOk/OC411ZcFyFfZ9hYj2NLRJ
86F+gxD7hhXzB8NYPiFeDWgN0FSh85QJMV3Q/IXTc9ZvIsiVv2rNtXlI8SI4
Li6t/mw8SPEi9B562WZzOPWjTITxM6+/6OCT53nD/JfY2QsV1B/wRkJFXYJq
O+sXbyznHYj6PJP6ReaNS5Pp67pt9yneB2OCgdliNVbfBzx3PZ31YLp/nA/O
zUQWpw2Rl/lg9HxExTyf3Tcx2p88VHxqTf0MMc6+E/dAnkLrOTHM8s7OjX9E
+5WJ8Uz/XqxpOov3hSxPPJUyy+r7Iir0mZVUMErxvohxUT1qrEHzReYLlO+9
HjbJ5pME5c1H/K430nyEBPOS/CyT45Sfk+D8jb7sLEfyMgkqS61Th86weeUH
t/jgq36hNB/hBz0FR5MTvXS/OT+ob77lGldP80zmh1lvQeZLr7F57g+xuYNg
YSuL98enNyPKFuQ0nzl/tGWlDi7H0LyX+UMp51uzJj7bfwCOLyrYvlHJ4gMg
sLXQueI+ZfsvV+3qBA==
           "]],
          FontSize->24]}, 
        {RGBColor[0, 
          NCache[
           Rational[2, 3], 0.6666666666666666], 0], PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
         Opacity[0.4], CapForm["Butt"], 
         StyleBox[LineBox[CompressedData["
1:eJxdlTloFFEYxxerECwstrCQJYrIGkQ0iXc2+8+5m3tndvYIpBJia+wkWrzC
2MbCQkVESBqbRUEwgsgzRjxIgnfivdrGIo3W2fnm/2Dee7A8fvxnvvnu3Xv2
vD+1I5FITDV+4R2drWx013knMDm39C89+YvchMXU7Ka3+JO8C8la7vdM0nAS
FzLN6/PTP8i7sboSnu/kPTgoBg23ILSWmv1G3oeGsYbFr+T96ArNZQwfwK2b
4flCTuN/OjS4QW6FLw4aPgRxr7ZOPgwx12z4CM7J+Uw+ijDauaVP5DZIuCnD
7bgkAX8kdyAy94F8DO1yDB/HNTH4nnwCf8NwN9+RTyIvARs+hYXQ3Pxb8mlE
t+EzzP8auRPy+PQqOQNJR3qF3IU/ks835Czz95oM5utVxArMz0vq3czHC+rd
EHMzy9R70CbxPqfew/ieUe9lPJp6L/1/Sr2P/j6h3ocb4t9j6v1oEn8eUe/H
Zfn+Q+oD/N4D6gO0X6Oeo7171HO4KO8vUM/jvjx/h3oeSvTr1AfJV6gPsh7m
DDn6kPP+MLRlf5i6+f4I7lr+jfB54/8otqz4Rum/iX/Myc+Yk79xJ7/jTv4L
dn1QsOunCuiI11cXmH9Tfw/L8f6Ah53x/lEegnh/aQ+3rf7zUY/3J3y7f5Vv
97f2nf4vsh6cDxTt+VFFe7500Zm/wJ5PBIyX86sCbMTnWweM38x/CS3x/YCS
vT9Uyd4vuuTsn7K9n1C295cq2/tNl539V7H3Iyqcd7Kq4Gp8v+oKWq39W8Va
fD+jynxzf6uqvd911dn/E/b/AyZYj3p2G3bG05M=
           "]],
          FontSize->24]}}, {{}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{False, False},
      AxesLabel->{None, None},
      AxesOrigin->{0., 0},
      BaseStyle->{FontSize -> 24},
      DisplayFunction->Identity,
      Frame->{{True, True}, {True, True}},
      FrameLabel->{{None, None}, {
         FormBox["\"Time\"", TraditionalForm], None}},
      FrameStyle->Automatic,
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{{0}, {0}},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImageSize->400,
      LabelStyle->{FontFamily -> "Times"},
      Method->{
       "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox["\"Signal\"", TraditionalForm],
      PlotRange->{{0., 101.}, {-0.07409300444805181, 0.6075367061899258}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], 
     TemplateBox[{"\"Exact signal\"", "\"Noisy signal\""},
      "LineLegend",
      DisplayFunction->(StyleBox[
        StyleBox[
         PaneBox[
          TagBox[
           GridBox[{{
              TagBox[
               GridBox[{{
                  GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 
                    NCache[
                    Rational[2, 3], 0.6666666666666666], 0], 
                    Opacity[0.4]], {
                    LineBox[{{0, 40}, {40, 40}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 
                    NCache[
                    Rational[2, 3], 0.6666666666666666], 0], 
                    Opacity[0.4]], {}}}, AspectRatio -> Full, 
                   ImageSize -> {40, 40}, PlotRangePadding -> None, 
                   ImagePadding -> Automatic, 
                   BaselinePosition -> (Scaled[0.4] -> Baseline)], #}, {
                  GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    Opacity[0.7], 
                    RGBColor[0.9, 0.36, 0.054]], {
                    LineBox[{{0, 40}, {40, 40}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    Opacity[0.7], 
                    RGBColor[0.9, 0.36, 0.054]], {}}}, AspectRatio -> Full, 
                   ImageSize -> {40, 40}, PlotRangePadding -> None, 
                   ImagePadding -> Automatic, 
                   BaselinePosition -> (Scaled[0.4] -> Baseline)], #2}}, 
                GridBoxAlignment -> {
                 "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                AutoDelete -> False, 
                GridBoxDividers -> {
                 "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}}, 
                GridBoxSpacings -> {"Columns" -> {{0.5}}, "Rows" -> {{0.8}}}],
                "Grid"]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
           "Grid"], Alignment -> Left, AppearanceElements -> None, 
          ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> "ResizeToFit"],
          LineIndent -> 0, StripOnInput -> False], {
         Directive[FontSize -> 24, FontFamily -> Automatic], FontFamily -> 
         "Arial"}, Background -> Automatic, StripOnInput -> False]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Opacity", "[", 
                 RowBox[{"0.4`", ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 
                    Rational[2, 3], 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0., 0.4444444444444444, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", 
                    FractionBox["2", "3"], ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 
                    Rational[2, 3], 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0, 
                    Rational[2, 3], 0], Editable -> False, Selectable -> 
                    False]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "0.7`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.9, 0.36, 0.054], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[0.6000000000000001, 0.24, 0.036000000000000004`],
                     FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.9`", ",", "0.36`", ",", "0.054`"}], "]"}], 
                    NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.9, 0.36, 0.054]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.9, 0.36, 0.054], Editable -> False, Selectable -> 
                    False]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}]}], "]"}]& )]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.822074828845477*^9, 3.822074852297296*^9}, 
   3.8224464900129957`*^9, 3.8224465437380533`*^9, {3.822446575346818*^9, 
   3.82244660234451*^9}, {3.822446657970254*^9, 3.82244668209202*^9}},
 CellLabel->"Out[74]=",ExpressionUUID->"885b0182-66fe-4ab0-a771-e141e0dcd1b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<example_abs_figures/signal.png\>\"", ",", "pltData", ",", 
   RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.822446606886797*^9, 3.822446632992075*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"46e33d7c-69c9-41a3-a24e-dac0866375f8"],

Cell[BoxData["\<\"example_abs_figures/signal.png\"\>"], "Output",
 CellChangeTimes->{3.8224466337873898`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"fadf2586-c90f-413b-97df-67179f4ac5f6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"diff", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RotateLeft", "[", "x", "]"}], "-", "x"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}], "/", 
   RowBox[{"(", "dx", ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822056435998011*^9, 3.82205644423831*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"c10c0c2c-3206-43dc-b3ee-ecaaf9f25a37"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"derivExact", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "<", "0.5"}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1", ",", "dx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"derivNoisy", "=", 
   RowBox[{"diff", "[", "dataNoisy", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pltDeriv", "=", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derivNoisy", ",", "derivExact"}], "}"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"styleNoisy", ",", "styleExact"}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "\"\<Derivative\>\""}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", "\"\<Time\>\"", "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8219961089012203`*^9, 3.8219961651182537`*^9}, {
  3.82199622398486*^9, 3.8219962244436827`*^9}, {3.821996325195032*^9, 
  3.821996326406733*^9}, {3.82199667315427*^9, 3.821996738230855*^9}, {
  3.821996812578195*^9, 3.8219968290157337`*^9}, {3.822008311910851*^9, 
  3.822008319855774*^9}, {3.8220564503929043`*^9, 3.822056452535637*^9}, {
  3.82207485444711*^9, 3.822074855654196*^9}, {3.822446648372746*^9, 
  3.822446690819137*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"9fd65200-44e1-4e9a-9ac0-f32df45b4699"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.9, 0.36, 0.054], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
     Opacity[0.7], CapForm["Butt"], 
     StyleBox[{
       LineBox[{{1., -6.551642418932635}, {1.9141549900638766`, 
        11.187324421321778`}}], 
       LineBox[{{2.0716932353595503`, 11.187324421321778`}, {
        3., -10.382016677326156`}, {4., -7.4192090290260415`}, {
        5., -5.0499599198669305`}, {6., 2.7475938841542313`}, {
        7., -9.562757545095268}, {8., 4.129889240144758}, {8.883144833847197, 
        11.187324421321778`}}], 
       LineBox[{{9.04647294749474, 11.187324421321778`}, {
        10., -7.972683464159935}, {11., 3.006666599572949}, {12., 
        1.2419014770974401`}, {13., -4.686696520185834}, {
        14., -3.2302175589543847`}, {15., -0.13289969723167538`}, {16., 
        9.054897419651969}, {16.80210573599856, -10.627763103341765`}}], 
       LineBox[{{17.188539949007613`, -10.627763103341765`}, {18., 
        10.272374473765622`}, {19., -7.744466628752744}, {
        20., -2.0517266433143444`}, {21., -7.502511921069788}, {
        21.998494766289436`, 11.187324421321778`}}], 
       LineBox[{{22.002070916049227`, 11.187324421321778`}, {
        23., -2.3895821019812855`}, {
        23.8308044936313, -10.627763103341765`}}], 
       LineBox[{{24.10487176003623, -10.627763103341765`}, {25., 
        3.6924018043883566`}, {26., -0.02686712925283885}, {
        27., -1.4145543196693673`}, {28., -0.646366283137581}, {29., 
        3.0820911649548366`}, {30., 8.772544340874678}, {
        30.81716996501513, -10.627763103341765`}}], 
       LineBox[{{31.29136625969295, -10.627763103341765`}, {
        32., -0.07110815182198582}, {33., -3.9118104049307463`}, {34., 
        10.86799270508363}, {34.911043908353165`, -10.627763103341765`}}], 
       LineBox[{{35.122812256187004`, -10.627763103341765`}, {36., 
        4.363559501743594}, {37., 1.647954583025066}, {
        38., -3.0408207678520234`}, {39., -5.796838107474539}, {40., 
        5.420440246317604}, {41., -1.2937370880955674`}, {
        42., -8.473394214480068}, {42.948547080562435`, 
        11.187324421321778`}}], 
       LineBox[{{43.061667071291325`, 11.187324421321778`}, {
        44., -5.040270266485653}, {45., -5.126785044085313}, {
        46., -0.12837070092488884`}, {47., 6.204635472376445}, {
        47.76720108970026, -10.627763103341765`}}], 
       LineBox[{{48.21101679435138, -10.627763103341765`}, {49., 
        8.469383236567582}, {50., -7.866004266543572}, {
        51., -2.4471052815929366`}, {52., 3.083356602900729}, {
        53., -1.7376423270509673`}, {54., 8.672653555460071}, {
        54.96397255531252, -10.627763103341765`}}], 
       LineBox[{{55.04182174085312, -10.627763103341765`}, {56., 
        5.898690975815627}, {57., -0.4212407197285453}, {
        58., -0.09130026973391964}, {58.912842719147406`, 
        11.187324421321778`}}], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQvebkh9+nOnwdMhf3/XkRr+bAAAZ+DrzVXW2XvbkP
gLkNfg7rA0My+rdJQOX9HdZr7o86b80K4Tf4O4QxXtm+uu6PPUQ+wEFq9ZuY
r60yEP0OAQ4SQuaXUlUuQOQbAhxWr0qfrZuqDNF/IMChZ/n5yN95IlDzAx3m
Gb19tnjCd4h6h0CH/sOM3LwK8lD3BDqo2j6I/JEpB9Uf6HDnKItNRIUyRJ4h
yOFF6EyvmdM3QvUHOTw1njUr1IYLqj/IIXiC70uv3TJQ/UEOFvVV+/KfCkDt
D3bo7dvvmbGLB8J3CHbIsJ+1Z08JM1R/sIP/kaTre7ih8geCHUrPuz3oPicN
tT/EgclmXtn6dexQ/SEO4m5z1H8f/gr1f4hDR8uZuvss3FD9IQ4362YYHV4l
ANUf6vDzhxX/5onSUP2hDt7ajTa3er5A9Yc6nPpid6//qyJUf6iD1uQ3kf8u
SUL1hzls+PrvsuQTKWj4hznIXD9wNosDGn8NYQ7JkzSDV+z8tB+iP8yBm3/y
u/oqVYeNx2YUTPoR5sD5K0Yry1H1AACFVaqs
        "]], 
       LineBox[{{93.11476693892173, 11.187324421321778`}, {94., 
        2.096850294148239}, {95., -1.5508240111054006`}, {
        96., -4.8339755134376885`}, {96.64038930926476, 
        11.187324421321778`}}], 
       LineBox[{{98.34761085182986, -10.627763103341765`}, {99., 
        4.079271334317119}, {100., -2.1573568507579024`}}], 
       LineBox[{{92.10874442480373, -10.627763103341765`}, {92.9543184948536, 
        11.187324421321778`}}], 
       LineBox[{{97.23278630430167, 11.187324421321778`}, {
        97.7972397302004, -10.627763103341765`}}]},
      FontSize->24]}, 
    {RGBColor[0, 
      NCache[
       Rational[2, 3], 0.6666666666666666], 0], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
     Opacity[0.4], CapForm["Butt"], 
     StyleBox[LineBox[CompressedData["
1:eJxd0zlKBEEAheGHkaGBgYGBioiIiPuu0+77Nu6pMLFXqJtZR/IIKg5KfwVF
8fXPC3v87b3bG0jS+74/7+/57PTfj/6Hpu1BPISH8QgexWN4Ak/iKTyNZ/As
nsPzeAEv4iW8jFfwKl7D63gDb+ItvI138C7u4KbtgrNHx9mn4xzQcQ7pOEd0
nGM6zgkd55SOc0b/c/8/OW+74FzQcS7pOFd0nGs6zg0d57btBhdcce7Y44Ir
Tpc9Lrji3LPHBVecB/a44IrzyB4XXHGe2OOCK84ze1xwxXlhjwuuOK/s//0F
Nt3dDw==
       "]],
      FontSize->24]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  BaseStyle->{FontSize -> 24},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {
     FormBox["\"Time\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{{0}, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->400,
  LabelStyle->{FontFamily -> "Times"},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Derivative\"", TraditionalForm],
  PlotRange->{{0., 101.}, {-10.627763103341765`, 11.187324421321778`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.822074841341732*^9, 3.822074855819798*^9}, 
   3.822446492911145*^9, {3.8224466535578537`*^9, 3.8224466912260847`*^9}},
 CellLabel->"Out[77]=",ExpressionUUID->"095b815a-6e19-49c7-bc5a-77ec8990fb2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<example_abs_figures/deriv.png\>\"", ",", "pltDeriv", ",", 
   RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8224466976865463`*^9, 3.8224467009166803`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"9c11fb9a-4fab-401b-9bd9-277fddfa716e"],

Cell[BoxData["\<\"example_abs_figures/deriv.png\"\>"], "Output",
 CellChangeTimes->{3.82244670139246*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"7f43dc7c-f925-42bb-b237-35e75f7bb185"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diff TVR", "Chapter",
 CellChangeTimes->{{3.8220745466620398`*^9, 
  3.8220745481070337`*^9}},ExpressionUUID->"855ceb4e-b9fa-4d58-9014-\
2655a9c3de0b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"derivGuess", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"Length", "[", "dataNoisy", "]"}], "+", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noOptSteps", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"derivFinal", "=", 
   RowBox[{"getDiffTVR", "[", 
    RowBox[{
    "dataNoisy", ",", "derivGuess", ",", "noOptSteps", ",", "dx", ",", 
     "alpha"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.822074560953826*^9, 3.8220745981923923`*^9}, {
   3.82207469390092*^9, 3.82207469543958*^9}, 3.82207495869233*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"55c65b8f-303d-4a14-a418-a9d7e9302925"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"leg", "=", 
   RowBox[{"LineLegend", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"styleExact", ",", "styleTVR"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Exact\>\"", ",", "\"\<TVR\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pTVR", "=", 
  RowBox[{"Grid", "[", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"derivExact", ",", "derivFinal"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"styleExact", ",", "styleTVR"}], "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Derivative\>\""}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", "\"\<Time\>\"", "}"}]}]}], "]"}], ",", "leg"}], "}"}], 
    "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.82207469882241*^9, 3.82207470188883*^9}, {
  3.8224467486684237`*^9, 3.822446813096903*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"abb074b4-a2b2-4e8d-b794-2fe64f73809c"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[{{}, {{}, {}, 
        {RGBColor[0, 
          NCache[
           Rational[2, 3], 0.6666666666666666], 0], PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
         Opacity[0.4], CapForm["Butt"], 
         StyleBox[LineBox[CompressedData["
1:eJxd0zlKBEEAheGHkaGBgYGBioiIiPuu0+77Nu6pMLFXqJtZR/IIKg5KfwVF
8fXPC3v87b3bG0jS+74/7+/57PTfj/6Hpu1BPISH8QgexWN4Ak/iKTyNZ/As
nsPzeAEv4iW8jFfwKl7D63gDb+ItvI138C7u4KbtgrNHx9mn4xzQcQ7pOEd0
nGM6zgkd55SOc0b/c/8/OW+74FzQcS7pOFd0nGs6zg0d57btBhdcce7Y44Ir
Tpc9Lrji3LPHBVecB/a44IrzyB4XXHGe2OOCK84ze1xwxXlhjwuuOK/s//0F
Nt3dDw==
           "]],
          FontSize->24]}, 
        {GrayLevel[0], PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
         CapForm["Butt"], 
         StyleBox[LineBox[CompressedData["
1:eJxFyw1M1HUcx/H/bocSIclETGGr7KbxUD4gBsrB57jjmXt+PgroFtRQIUck
06ijlqVFzvFs0ylteNCdDTUfmotzDkHhmCRXFIFIpJAILIZAzKMc/9/X//bb
f6/f5/d+yVqkyRNwHJf//3nyX/qmEmrWDz/nsUy18hd42D7Y1Uv2hXm4QfDU
K9Ezu+zsz+QgnCsI9twiP4/5uNC3usmhONQSoO8kv4isG/4X28nrkSaxV1wj
i2CWZIz8RN6AUmdk52XyK9h4XiI9Tw5Ha6ou5Qw5Er+NftJ7mvwarC2JQyfJ
m3FJ7s6pJ29BrjxScZS8FZdlV09/QY5CZaPS+DF5GyIGl6eXkKNR2tdWWEDe
juT4yMZs8uswSd/uV5Nj0L3jgL+MHIud7tqwaPIO1K0bmxGRdyIk2m5ZRY5D
0eOoAo4sRq7jZti4mTke8uD6pl/ICfBYTP4uMlAQ2/KmndkGLLbmBR6hXQJ1
iSi3mHYJBHruopb2RPjKp8+E054IYY7jh79MbJeiTbFlq4XZJsX8H9dD3jCy
XYajH5bX7dezXYa6W3crXWq2J+FvY9SppAy2J6G4fnPxPNiejIbZzOqqTWxP
xsj71rnfV7M9BSXvxFX53pnk9xQcu7HKUKTkzaXCsnuF+ELcBL+n4td9jaUr
VOP8noYHZc6Fkt2j/J6GwOjmR3tevsvv6RDaLRXesx38ng7H8bEN7du7E5b2
DHwnk89V9Q8v2ZaBpOsLxd8Ix/g9E9XZ+V968IDfM+HjU+iZGeDNyZFfMfBR
2ALb5dh1aubeJi/bFXCvNsj3MtsUcEwbSmppV6LwCsSXaFdisMfq7aVdhe/L
Co9MMEOFkUnbCZ9F9l6FmNlaxzpmlwqfZYm8rzJzamSVdzgTmKFG6IGbo0rq
1dDkXJ3Opl6NC5hZuYd6DSK+7srbT70Gcx0fBHxOvQa3v+0LqaReg5CIXQdP
UK9FSPna+CbqtTj0XkPMOeq1cCmGyq5Qr0XPj34vtFGvw0SQPdxNvQ6j8gFH
L/U6LHia7f3U65AtnFozTL0e3jvOufvU6yFeK5U/pF6PvvHAoH+o1+Og4Vrm
I+oNELtvL85Tb8C9EX/JY+oNaHNWiDhunO8N2Pjp3iYBM2fE0LPvdgqZYUTz
ZObhZcw2IwKmi6eWU2+Ej1UoeIZ6Eyx+0lYyTGj7al+sH/UmHKvZZiO7TPhT
uaaOzJnRJfu3lgwz7iscNU97M4KNuuon/g+vfRXM
           "]],
          FontSize->24]}}, {{}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{False, False},
      AxesLabel->{None, None},
      AxesOrigin->{0., 0},
      BaseStyle->{FontSize -> 24},
      DisplayFunction->Identity,
      Frame->{{True, True}, {True, True}},
      FrameLabel->{{None, None}, {
         FormBox["\"Time\"", TraditionalForm], None}},
      FrameStyle->Automatic,
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{{0}, {0}},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImageSize->400,
      LabelStyle->{FontFamily -> "Times"},
      Method->{
       "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox["\"Derivative\"", TraditionalForm],
      PlotRange->{{0., 102.}, {-1.0221758480494478`, 1.}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], 
     TemplateBox[{"\"Exact\"", "\"TVR\""},
      "LineLegend",
      DisplayFunction->(StyleBox[
        StyleBox[
         PaneBox[
          TagBox[
           GridBox[{{
              TagBox[
               GridBox[{{
                  GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 
                    NCache[
                    Rational[2, 3], 0.6666666666666666], 0], 
                    Opacity[0.4]], {
                    LineBox[{{0, 40}, {40, 40}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 
                    NCache[
                    Rational[2, 3], 0.6666666666666666], 0], 
                    Opacity[0.4]], {}}}, AspectRatio -> Full, 
                   ImageSize -> {40, 40}, PlotRangePadding -> None, 
                   ImagePadding -> Automatic, 
                   BaselinePosition -> (Scaled[0.4] -> Baseline)], #}, {
                  GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {
                    LineBox[{{0, 40}, {40, 40}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {}}}, AspectRatio -> Full, 
                   ImageSize -> {40, 40}, PlotRangePadding -> None, 
                   ImagePadding -> Automatic, 
                   BaselinePosition -> (Scaled[0.4] -> Baseline)], #2}}, 
                GridBoxAlignment -> {
                 "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                AutoDelete -> False, 
                GridBoxDividers -> {
                 "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}}, 
                GridBoxSpacings -> {"Columns" -> {{0.5}}, "Rows" -> {{0.8}}}],
                "Grid"]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
           "Grid"], Alignment -> Left, AppearanceElements -> None, 
          ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> "ResizeToFit"],
          LineIndent -> 0, StripOnInput -> False], {
         Directive[FontSize -> 24, FontFamily -> Automatic], FontFamily -> 
         "Arial"}, Background -> Automatic, StripOnInput -> False]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Opacity", "[", 
                 RowBox[{"0.4`", ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 
                    Rational[2, 3], 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0., 0.4444444444444444, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", 
                    FractionBox["2", "3"], ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 
                    Rational[2, 3], 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0, 
                    Rational[2, 3], 0], Editable -> False, Selectable -> 
                    False]}], "]"}], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                   "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                   FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                   PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                  StyleBox[
                   RowBox[{"GrayLevel", "[", "0", "]"}], NumberMarks -> 
                   False]], Appearance -> None, BaseStyle -> {}, 
                 BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                 ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0], Editable -> False, Selectable -> False]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}]}], "]"}]& )]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.822074702082614*^9, {3.822446744728297*^9, 3.822446813446579*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"d2ebcc02-90dd-4dd5-838e-aa588b3a3233"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<example_abs_figures/tvr.png\>\"", ",", "pTVR", ",", 
   RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.822446817698717*^9, 3.822446819918166*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"c828532c-83de-49d8-ad7b-c7c0a1ec1b3e"],

Cell[BoxData["\<\"example_abs_figures/tvr.png\"\>"], "Output",
 CellChangeTimes->{3.822446820529744*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"d4c56ba0-2a35-4b4b-bc1c-7526372f9ceb"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1468, 842},
WindowMargins->{{Automatic, 83}, {Automatic, 29}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"afa6823d-5f55-46c4-96cb-eb38744d540a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 157, 3, 69, "Chapter",ExpressionUUID->"f506f164-c0f0-463a-b883-cac9e42bcd3a"],
Cell[740, 27, 397, 8, 52, "Input",ExpressionUUID->"f3e032d6-f11e-456f-9a3e-5a51888c61c1"],
Cell[CellGroupData[{
Cell[1162, 39, 195, 3, 30, "Input",ExpressionUUID->"3ace6ebf-5416-4142-8769-81bdbabe7877"],
Cell[1360, 44, 4565, 111, 95, "Output",ExpressionUUID->"828a75ba-f5c3-488d-9d6c-c4da9503e135"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5974, 161, 217, 4, 98, "Title",ExpressionUUID->"b7f822b6-9baf-4688-a125-f8509e18632f"],
Cell[CellGroupData[{
Cell[6216, 169, 151, 3, 69, "Chapter",ExpressionUUID->"a392b314-8eaf-4606-b7c2-350ea789a805"],
Cell[6370, 174, 2609, 64, 262, "Input",ExpressionUUID->"78221468-84d4-4909-8592-d7ee93cf5a0e"],
Cell[CellGroupData[{
Cell[9004, 242, 2430, 59, 115, "Input",ExpressionUUID->"62725fc3-d230-4d44-a76a-5cdd913fd5a5"],
Cell[11437, 303, 13183, 279, 319, "Output",ExpressionUUID->"885b0182-66fe-4ab0-a771-e141e0dcd1b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24657, 587, 455, 9, 52, "Input",ExpressionUUID->"46e33d7c-69c9-41a3-a24e-dac0866375f8"],
Cell[25115, 598, 188, 2, 34, "Output",ExpressionUUID->"fadf2586-c90f-413b-97df-67179f4ac5f6"]
}, Open  ]],
Cell[25318, 603, 491, 14, 46, "Input",ExpressionUUID->"c10c0c2c-3206-43dc-b3ee-ecaaf9f25a37",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25834, 621, 1442, 33, 73, "Input",ExpressionUUID->"9fd65200-44e1-4e9a-9ac0-f32df45b4699"],
Cell[27279, 656, 6216, 128, 320, "Output",ExpressionUUID->"095b815a-6e19-49c7-bc5a-77ec8990fb2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33532, 789, 459, 9, 52, "Input",ExpressionUUID->"9c11fb9a-4fab-401b-9bd9-277fddfa716e"],
Cell[33994, 800, 184, 2, 34, "Output",ExpressionUUID->"7f43dc7c-f925-42bb-b237-35e75f7bb185"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34227, 808, 157, 3, 69, "Chapter",ExpressionUUID->"855ceb4e-b9fa-4d58-9014-2655a9c3de0b"],
Cell[34387, 813, 799, 20, 94, "Input",ExpressionUUID->"55c65b8f-303d-4a14-a418-a9d7e9302925"],
Cell[CellGroupData[{
Cell[35211, 837, 1074, 28, 52, "Input",ExpressionUUID->"abb074b4-a2b2-4e8d-b794-2fe64f73809c"],
Cell[36288, 867, 11797, 258, 321, "Output",ExpressionUUID->"d2ebcc02-90dd-4dd5-838e-aa588b3a3233"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48122, 1130, 453, 10, 52, "Input",ExpressionUUID->"c828532c-83de-49d8-ad7b-c7c0a1ec1b3e"],
Cell[48578, 1142, 187, 3, 34, "Output",ExpressionUUID->"d4c56ba0-2a35-4b4b-bc1c-7526372f9ceb"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

